{% extends "base.html" %}

{% block content %}
<h2>Fach bearbeiten</h2>

{% if error %}
<div style="background-color: #f8d7da; color: #721c24; padding: 10px; margin-bottom: 15px; border: 1px solid #f5c6cb; border-radius: 4px;">
  {{ error }}
</div>
{% endif %}

<form method="post">

  <label>Fach:</label><br>
  <select id="subjectSelect" name="subject" required onchange="toggleCustomInput()">
    <option value="">-- Fach auswählen --</option>
    <option value="Mathematik" {% if fach.fachname == 'Mathematik' %}selected{% endif %}>Mathematik</option>
    <option value="Deutsch" {% if fach.fachname == 'Deutsch' %}selected{% endif %}>Deutsch</option>
    <option value="Englisch" {% if fach.fachname == 'Englisch' %}selected{% endif %}>Englisch</option>
    <option value="Französisch" {% if fach.fachname == 'Französisch' %}selected{% endif %}>Französisch</option>
    <option value="Geschichte" {% if fach.fachname == 'Geschichte' %}selected{% endif %}>Geschichte</option>
    <option value="Geografie" {% if fach.fachname == 'Geografie' %}selected{% endif %}>Geografie</option>
    <option value="Biologie" {% if fach.fachname == 'Biologie' %}selected{% endif %}>Biologie</option>
    <option value="Chemie" {% if fach.fachname == 'Chemie' %}selected{% endif %}>Chemie</option>
    <option value="Physik" {% if fach.fachname == 'Physik' %}selected{% endif %}>Physik</option>
    <option value="Informatik" {% if fach.fachname == 'Informatik' %}selected{% endif %}>Informatik</option>
    <option value="Wirtschaft & Recht" {% if fach.fachname == 'Wirtschaft & Recht' %}selected{% endif %}>Wirtschaft & Recht</option>
    <option value="Musik" {% if fach.fachname == 'Musik' %}selected{% endif %}>Musik</option>
    <option value="Bildnerisches Gestalten" {% if fach.fachname == 'Bildnerisches Gestalten' %}selected{% endif %}>Bildnerisches Gestalten</option>
    <option value="Sport" {% if fach.fachname == 'Sport' %}selected{% endif %}>Sport</option>
    <option value="custom" {% if fach.fachname not in ['Mathematik', 'Deutsch', 'Englisch', 'Französisch', 'Geschichte', 'Geografie', 'Biologie', 'Chemie', 'Physik', 'Informatik', 'Wirtschaft & Recht', 'Musik', 'Bildnerisches Gestalten', 'Sport'] %}selected{% endif %}>Anderes (Ergänzungsfach)</option>
  </select><br>
  <input type="text" id="customSubject" name="custom_subject" value="{% if fach.fachname not in ['Mathematik', 'Deutsch', 'Englisch', 'Französisch', 'Geschichte', 'Geografie', 'Biologie', 'Chemie', 'Physik', 'Informatik', 'Wirtschaft & Recht', 'Musik', 'Bildnerisches Gestalten', 'Sport'] %}{{ fach.fachname }}{% endif %}" placeholder="Eigenes Fach eingeben" style="{% if fach.fachname not in ['Mathematik', 'Deutsch', 'Englisch', 'Französisch', 'Geschichte', 'Geografie', 'Biologie', 'Chemie', 'Physik', 'Informatik', 'Wirtschaft & Recht', 'Musik', 'Bildnerisches Gestalten', 'Sport'] %}display:block;{% else %}display:none;{% endif %} margin-top: 10px;"><br><br>
  
  <script>
    function toggleCustomInput() {
      const select = document.getElementById('subjectSelect');
      const customInput = document.getElementById('customSubject');
      
      if (select.value === 'custom') {
        customInput.style.display = 'block';
        customInput.required = true;
        select.removeAttribute('name');
        customInput.setAttribute('name', 'subject');
      } else {
        customInput.style.display = 'none';
        customInput.required = false;
        customInput.removeAttribute('name');
        select.setAttribute('name', 'subject');
      }
    }
    
    // Run on page load to set correct name attribute
    window.addEventListener('DOMContentLoaded', function() {
      toggleCustomInput();
    });
  </script>

  <label>Raum:</label><br>
  <input type="text" name="room" value="{{ fach.raumnummer }}" required><br><br>

  <label>Wochentag:</label><br>
  <select name="weekday" required>
    <option value="1" {% if fach.weekday == '1' %}selected{% endif %}>Montag</option>
    <option value="2" {% if fach.weekday == '2' %}selected{% endif %}>Dienstag</option>
    <option value="3" {% if fach.weekday == '3' %}selected{% endif %}>Mittwoch</option>
    <option value="4" {% if fach.weekday == '4' %}selected{% endif %}>Donnerstag</option>
    <option value="5" {% if fach.weekday == '5' %}selected{% endif %}>Freitag</option>
  </select><br><br>

  <label>Zeitblock:</label><br>
  <select name="timeblock" required>
    <option value="08:45-09:25" {% if fach.startzeit == '08:45' %}selected{% endif %}>08:45 – 09:25</option>
    <option value="09:35-10:20" {% if fach.startzeit == '09:35' %}selected{% endif %}>09:35 – 10:20</option>
    <option value="10:35-11:20" {% if fach.startzeit == '10:35' %}selected{% endif %}>10:35 – 11:20</option>
    <option value="11:30-12:15" {% if fach.startzeit == '11:30' %}selected{% endif %}>11:30 – 12:15</option>
    <option value="13:20-14:05" {% if fach.startzeit == '13:20' %}selected{% endif %}>13:20 – 14:05</option>
    <option value="14:15-15:00" {% if fach.startzeit == '14:15' %}selected{% endif %}>14:15 – 15:00</option>
  </select><br><br>

  <button type="submit">Aktualisieren</button>
  <a href="{{ url_for('teacher_week') }}" style="margin-left: 10px;">Abbrechen</a>

</form>
{% endblock %}
