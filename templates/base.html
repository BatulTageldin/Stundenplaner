<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <title>Organizer</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}">

    <style>
      :root {
        --bg-primary: #f9f9f9;
        --bg-secondary: #fff;
        --text-primary: #333;
        --text-secondary: #999;
        --border-color: rgba(0,0,0,0.06);
        --shadow: 0 2px 5px rgba(0,0,0,0.06);
        --navbar-bg: #222;
        --navbar-text: #9d9d9d;
        --navbar-active: #fff;
        --input-bg: #fff;
        --input-border: #ccc;
      }

      [data-theme="dark"] {
        --bg-primary: #1a1a1a;
        --bg-secondary: #2d2d2d;
        --text-primary: #e0e0e0;
        --text-secondary: #888;
        --border-color: rgba(255,255,255,0.1);
        --shadow: 0 2px 5px rgba(0,0,0,0.3);
        --navbar-bg: #0a0a0a;
        --navbar-text: #aaa;
        --navbar-active: #fff;
        --input-bg: #3a3a3a;
        --input-border: #555;
      }

      body { 
        background-color: var(--bg-primary);
        color: var(--text-primary);
        transition: background-color 0.3s, color 0.3s;
      }
      
      .todo-list { margin-top: 30px; list-style: none; padding: 0; }
      .todo-item {
        position: relative; 
        background: var(--bg-secondary);
        color: var(--text-primary);
        padding: 16px 20px 12px 20px; margin-bottom: 16px; border-radius: 8px;
        box-shadow: var(--shadow); 
        line-height: 1.5;
        transition: background-color 0.3s;
      }
      .todo-content { font-weight: 600; }
      .todo-date { display: block; color: var(--text-secondary); font-size: 0.9em; margin-top: 6px; }
      .todo-form { 
        margin-top: 28px; 
        background: var(--bg-secondary);
        color: var(--text-primary);
        padding: 16px; border-radius: 8px; 
        box-shadow: var(--shadow);
        transition: background-color 0.3s;
      }
      .todo-item { display: block; }
      .todo-complete-form {
        display: flex;
        align-items: center;
        gap: 20px;
        margin: 0; padding: 0; border: 0; background: transparent;
      }
      .todo-checkbox {
        width: 20px; height: 20px; margin: 0;
        accent-color: #5cb85c;
      }
      .todo-content { font-weight: 600; flex: 1; }
      .navbar-brand { font-weight: 600; }
      
      /* Dark mode inputs */
      [data-theme="dark"] input,
      [data-theme="dark"] select,
      [data-theme="dark"] textarea {
        background-color: var(--input-bg);
        color: var(--text-primary);
        border-color: var(--input-border);
      }
      
      [data-theme="dark"] .form-control {
        background-color: var(--input-bg);
        color: var(--text-primary);
        border-color: var(--input-border);
      }
      
      [data-theme="dark"] .navbar-inverse {
        background-color: var(--navbar-bg);
        border-color: var(--navbar-bg);
      }
      
      .theme-toggle {
        cursor: pointer;
        padding: 10px 15px;
        background: none;
        border: none;
        color: var(--navbar-text);
        font-size: 20px;
        transition: color 0.3s;
      }
      
      .theme-toggle:hover {
        color: var(--navbar-active);
      }
    </style>
  </head>

  <body>  
    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
            data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Navigation umschalten</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
         {% if current_user.is_authenticated %}
          <a class="navbar-brand" href="#">Hallo, {{ current_user.username }}</a>
         {% else %}
          <a class="navbar-brand" href="/">Willkommen</a>
         {% endif %}

        </div>

        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">

            {% if current_user.is_authenticated %}

              {% if current_user.role == 'student' %}
              <li><a href="{{ url_for('week_view') }}">Stundenplan</a></li>
              <li><a href="{{ url_for('add_schedule') }}">Fach zum Stundenplan</a></li>
              <li><a href="{{ url_for('pluspunkte') }}">Pluspunkte</a></li>
              <li><a href="{{ url_for('zielrechner') }}">Was brauche ich noch?</a></li>
              {% elif current_user.role == 'teacher' %}
              <li><a href="{{ url_for('teacher_week') }}">Alle F√§cher</a></li>
              <li><a href="{{ url_for('add_lesson') }}">Fach hinzuf√ºgen</a></li>
              {% endif %}
              <li><a href="{{ url_for('logout') }}">Logout</a></li>

            {% else %}

              <li><a href="{{ url_for('login') }}">Login</a></li>
              <li><a href="{{ url_for('register') }}">Registrieren</a></li>

            {% endif %}
            
            <li>
              <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">
                üåô
              </button>
            </li>

          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
        {% block content %}{% endblock %}
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    
    <script>
      // Theme toggle functionality
      function toggleTheme() {
        const html = document.documentElement;
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        
        // Update button icon
        const button = document.getElementById('themeToggle');
        button.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      }
      
      // Load saved theme on page load
      (function() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        
        // Update button icon
        const button = document.getElementById('themeToggle');
        if (button) {
          button.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }
      })();
    </script>
  </body>
</html>
